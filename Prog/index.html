<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <canvas id="my_canvas" width="800" height="800"></canvas>

    <script type="text/javascript">
        const my_canvas = document.getElementById('my_canvas');
        const ctx = my_canvas.getContext('2d');

        


        let y = 300;
        let x = 300;

        let speed = 0;

        var direction = "";

        function getRandomColor() {
            var trans = '0.5';
            var color = 'rgba(';
            for (var i = 0; i < 3; i++) {
                color += Math.floor(Math.random() * 255) + ',';
            }
            color += trans + ')'; 
            return color;
        }
        

        class constructorRectangulo {
            constructor(x, y, w, h, c, s) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
                this.c = c;
                this.s = s;
            }

            tocando(otro) {
                if (this.x < otro.x + otro.w &&
                    this.x + this.w > otro.x &&
                    this.y < otro.y + otro.h &&
                    this.y + this.h > otro.y) {

                    return true;
                }
                return false;
            }
        }

        document.addEventListener("keydown", function (e) {
            console.log(e)

            switch (e.keyCode) {
                case 37:
                    direction = "left";
                    break;
                case 38:
                    direction = "up";
                    break;
                case 39:
                    direction = "right";
                    break;
                case 40:
                    direction = "down";
                    break;
                case 32:
                    direction = "space";
                    speed = speed + 0.5;
                    break;
            }
        })

        function update() {
            switch (direction) {
                case "left":
                    if (speed > 10) {
                        player.x = player.x - 10 - speed;
                    } else {
                        player.x = player.x - 10;
                    }
                    if (player.x <= -40) {
                        player.x = 830;
                    }
                    break;
                case "up":
                    if (speed > 10) {
                        player.y = player.y - 10 - speed;
                    } else {
                        player.y = player.y - 10;
                    }
                    if (player.y <= -40) {
                        player.y = 830;
                    }
                    break;
                case "right":
                    if (speed > 10) {
                        player.x = player.x + 10 + speed;
                    } else {
                        player.x = player.x + 10;
                    }
                    if (player.x >= 800) {
                        player.x = -40;
                    }
                    break;
                case "down":
                    if (speed > 10) {
                        player.y = player.y + 10 + speed;
                    } else {
                        player.y = player.y + 10;
                    }
                    if (player.y >= 800) {
                        player.y = -40;
                    }
                    break;
            }
            if (player.tocando(target)) {
                target.x = Math.random() * 800;
                target.y = Math.random() * 800;
            }
            
        
            
        }

        function pintar() {

            if (player.tocando(muro)) {
                switch(direction){
                    case "left":
                        player.x+=10;
                    break;

                    case "up":
                        player.y+=10;

                    break;
                    case "right":
                        player.x-=10;
                   
                    break;

                    case "down":
                        player.y-=10;

                    break;
                }
                direction="";

            }
            ctx.fillStyle = 'lightgreen';
            ctx.fillRect(0, 0, 800, 800);

            ctx.fillStyle = getRandomColor();

            ctx.fillRect(player.x, player.y, 50, 50);
            ctx.strokeRect(player.x, player.y, 50, 50);

            ctx.fillRect(target.x, target.y, 20, 20);
            ctx.strokeRect(target.x, target.y, 20, 20);

            ctx.fillRect(muro.x,muro.y,60,100);
            ctx.strokeRect(muro.x,muro.y,60,100);

            
            

            update();
            requestAnimationFrame(pintar);
        }

        requestAnimationFrame(pintar);

      

       
        const player = new constructorRectangulo(280, 280, 50, 50, getRandomColor(), 10);
        const target = new constructorRectangulo(280, 280, 20, 20, "red", 0);
        const muro = new constructorRectangulo(40, 60,60, 100, "red", 0);




    </script>
   
</body>

</html>