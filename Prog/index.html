<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego con Pausa y Score</title>
</head>

<body>
    <canvas id="my_canvas" width="800" height="800"></canvas>
    <p>Score: <span id="score">0</span></p>
    <button id="pauseButton">Pausar</button>

    <script type="text/javascript">
        const my_canvas = document.getElementById('my_canvas');
        const ctx = my_canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score');
        const pauseButton = document.getElementById('pauseButton');

        let speed = 0;
        let direction = "";
        let paused = false;
        let score = 0;

        function getRandomColor() {
            var trans = '0.5';
            var color = 'rgba(';
            for (var i = 0; i < 3; i++) {
                color += Math.floor(Math.random() * 255) + ',';
            }
            color += trans + ')';
            return color;
        }

        class Rectangulo {
            constructor(x, y, w, h, c) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
                this.c = c;
            }

            draw() {
                ctx.fillStyle = this.c;
                ctx.fillRect(this.x, this.y, this.w, this.h);
                ctx.strokeRect(this.x, this.y, this.w, this.h);
            }

            tocando(otro) {
                return (this.x < otro.x + otro.w &&
                    this.x + this.w > otro.x &&
                    this.y < otro.y + otro.h &&
                    this.y + this.h > otro.y);
            }
        }

        document.addEventListener("keydown", function (e) {
            switch (e.keyCode) {
                case 37: direction = "left"; break;
                case 38: direction = "up"; break;
                case 39: direction = "right"; break;
                case 40: direction = "down"; break;
                case 32: speed += 0.5; break;
                case 80: togglePause(); break; 
            }
        });

        pauseButton.addEventListener('click', togglePause);

        function togglePause() {
            paused = !paused;
            if (!paused) {
                requestAnimationFrame(pintar);
                pauseButton.innerText = "Pausar";
            } else {
                pauseButton.innerText = "Reanudar";
            }
        }

        function update() {
            if (paused) return; 

            switch (direction) {
                case "left": player.x -= 10 + speed; break;
                case "up": player.y -= 10 + speed; break;
                case "right": player.x += 10 + speed; break;
                case "down": player.y += 10 + speed; break;
            }

         
            if (player.x < -40) player.x = 830;
            if (player.x > 800) player.x = -40;
            if (player.y < -40) player.y = 830;
            if (player.y > 800) player.y = -40;

           
            if (player.tocando(target)) {
                target.x = Math.random() * 780;
                target.y = Math.random() * 780;
                score += 10; 
                scoreDisplay.innerText = score;
            }

            
            for (let muro of muros) {
                if (player.tocando(muro)) {
                    switch (direction) {
                        case "left": player.x += 10 + speed; break;
                        case "up": player.y += 10 + speed; break;
                        case "right": player.x -= 10 + speed; break;
                        case "down": player.y -= 10 + speed; break;
                    }
                    direction = "";
                }
            }
        }

        function pintar() {
            if (paused) return; 

            ctx.clearRect(0, 0, my_canvas.width, my_canvas.height);

           
            ctx.fillStyle = 'lightgreen';
            ctx.fillRect(0, 0, my_canvas.width, my_canvas.height);

            
            player.draw();
            target.draw();
            muros.forEach(muro => muro.draw());

            update();
            requestAnimationFrame(pintar);
        }

       
        const player = new Rectangulo(280, 280, 50, 50, getRandomColor());
        const target = new Rectangulo(Math.random() * 780, Math.random() * 780, 20, 20, "red");

        
        const muros = [
            new Rectangulo(40, 60, 60, 200, "rgba(0, 0, 0, 0.5)"),
            new Rectangulo(300, 400, 60, 200, "rgba(0, 0, 0, 0.5)"),
            new Rectangulo(500, 100, 60, 200, "rgba(0, 0, 0, 0.5)")
        ];

        requestAnimationFrame(pintar);
    </script>
</body>

</html>
